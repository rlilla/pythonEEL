<!DOCTYPE html>
<html lang="en">
<head>
    <link rel="stylesheet" href="/css/bootstrap.min.css">
    <script src="/js/bootstrap.min.js"></script>
    <meta charset="UTF-8">
    <script type="text/javascript" src="/eel.js"></script>

    <title>LISTA DE PREÇO ITENS FORA DE LINHA</title>
    <script>
        function cambio(){
            var req=new XMLHttpRequest();
            req.onreadystatechange = function() {
            if (this.readyState == 4 && this.status == 200){
                resposta=req.responseText;
                //console.log(resposta);
                var valoresAtuais=JSON.parse(resposta);
                console.log(valoresAtuais["USD"]["ask"]);
                document.getElementById("dolar").innerHTML = `Cotação do dólar: ${Number(valoresAtuais["USD"]["ask"]).toFixed(2)}`;
            }
	}
            req.open("GET"," https://economia.awesomeapi.com.br/all/USD-BRL",true);
            req.send();
        }

        function pesquisa(){
            cambio();
            var valor=document.getElementById("txtCod").value
            console.log(valor)
            eel.consultar(valor)((ee) => {
            let lista=""
            for(x in ee["codigo"]){
                //lista+="<p id=\">" + ee["codigo"][x] + "\"onclick=\"func3(this.id)\">" + ee["codigo"][x] + "  " + ee["descricao"][x] + "</p>"
                //lista+=`<p id=${ee["codigo"][x]} onclick="func3(this.id)"> ${ee["codigo"][x]} ${ee["descricao"][x]} </p>`
                lista+=`<tr><td>${ee["codigo"][x]}</td><td>${ee["descricao"][x]}</td><td>US$ ${ee["preco"][x].toFixed(2)}</td></tr>`
            }

            let tabela = `<table class="table table-striped"><thead><tr><th>Código</th><th>Descrição</th><th>Preço</th></tr></thead>`;


            document.getElementById("divTabela").innerHTML = tabela + lista + "</table>"
        })
        }


        function func3(id){
            console.log(id)
        }

    </script>
</head>
<body class="bg-primary">
    <div class="container p-3 my-3 bg-primary text-white">
        <h4>Digite no campo abaixo o código ou parte da descrição do equipamento desejado.</h4><BR>
        <h4>OBS.: Itens terminados em FW precisam ser acompanhados do firmware.</h4> <BR>
        <h4>Caso o item desejado não seja encontrado, entrar em contato com Fabio Luciano</h4><BR>
        <h4>Código ou Descrição:</h4> <input type="text" id="txtCod" onkeyup="pesquisa()")><BR><BR>
        <div id="dolar">Cotação do dólar:</div>
    <div id="divTabela">

    </div>
    </div>
</body>
</html>